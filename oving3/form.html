<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Form</title>
    <style>
        /* Styling for the image preview */
        .image-preview {
            width: 150px;
            height: 150px;
            border: 2px solid #ddd;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 10px;
        }
        .image-preview img {
            max-width: 100%;
            max-height: 100%;
        }
    </style>
</head>
<body>
    <h1>Mandatory data collection (we are not selling this I promise)</h1>
    <form>
        <label for="fname">First name:</label><br>
        <input type="text" id="fname" name="fname" required><br>
        <label for="lname">Last name:</label><br>
        <input type="text" id="lname" name="lname" required><br>

        <label for="email">Email Address:</label><br>
        <input type="text" id="email" name="email" required><br>
        <label for="pswd">Password:</label><br>
        <input type="password" id="pswd" name="pswd" minlength="8" required><br>

        <label for="tel">Phone Number:</label><br>
        <input type="phone" id="phone" name="phone" placeholder="(123) 456-7890" pattern="\(\d{3}\)\s\d{3}-\d{4}" maxlength="14" required><br>
        <label for="dob">Date of birth:</label><br>
        <input type="date" id="dob" name="dob" required><br>
        <label for="country">Country of residence:</label><br>
        <select id="country" name="country" required>
            <option value="no">Norway</option>
            <option value="se">Sweden</option>
            <option value="dk">Denmark</option>
            <option value="uk">United Kingdom</option>
            <option value="us">United States</option>
            <option value="other">Other</option>
        </select><br>

        <span>Disclose your gender:</span><br>
        <input type="radio" id="male" name="interests" value="Male">
        <label for="male">Male</label><br>
        <input type="radio" id="female" name="interests" value="Female">
        <label for="female">Female</label><br>
        <input type="radio" id="other" name="interests" value="Other">
        <label for="other">Other</label><br>

        <span>Any interests?</span><br>
        <input type="checkbox" id="html" name="interests" value="HTML">
        <label for="html">HTML</label><br>
        <input type="checkbox" id="css" name="interests" value="CSS">
        <label for="css">CSS</label><br>
        <input type="checkbox" id="javascript" name="interests" value="JavaScript">
        <label for="javascript">JavaScript</label><br>

        <label for="comments">Any additional comments?</label><br>
        <input type="text" id="comments" name="comments"><br>
        <label for="satisfaction">How satisfied are you with this form?</label><br>
        <span>1</span>
        <input type="range" id="satisfaction" name="satisfaction" min="1" max="10" required>
        <span>10</span><br>

        <label for="pfp">Upload a profile picture!</label><br>
        <input type="file" name="pfp" id="mypfp" accept="image/*">
        <div class="image-preview" id="imagePreview">
            <span>No image selected</span>
        </div>  
        <input type="submit" value="Submit">
        <input type="reset" value="Reset">

    </form>
    <script>
        // Automatically filling in the format as the user types the phone number
        const phoneInput = document.getElementById('phone');

        phoneInput.addEventListener('input', function (e) {
            let input = e.target.value.replace(/\D/g, ''); // Remove all non-numeric characters
            let formattedInput = "";

            if (input.length > 0) {
                formattedInput += "(" + input.substring(0, 3); // Area code
            }
            if (input.length >= 4) {
                formattedInput += ") " + input.substring(3, 6); // Prefix
            }
            if (input.length >= 7) {
                formattedInput += "-" + input.substring(6, 10); // Line number
            }

            e.target.value = formattedInput;
        });

        // Setting the date input max to 18 years ago on page load
        const birthdateInput = document.getElementById('dob');
        const today = new Date();
        const year = today.getFullYear() - 18;
        const month = String(today.getMonth() + 1).padStart(2, '0'); // Months are 0-based
        const day = String(today.getDate()).padStart(2, '0');
        
        // Set the max value to the date 18 years ago
        birthdateInput.max = `${year}-${month}-${day}`;

        // Displaying a preview of the uploaded profile image, should there be one.
        const fileInput = document.getElementById('mypfp');
        const imagePreview = document.getElementById('imagePreview');

        fileInput.addEventListener('change', function() {
            const file = this.files[0];
            if (file) {
                const reader = new FileReader();
                imagePreview.innerHTML = ""; // Clear previous content
                
                reader.onload = function(event) {
                    const imgElement = document.createElement('img');
                    imgElement.src = event.target.result;
                    imagePreview.appendChild(imgElement);
                };
                
                reader.readAsDataURL(file); // Read the file as a data URL
            } else {
                imagePreview.innerHTML = "<span>No image selected</span>"; // Reset preview if no file is selected
            }
        });
    </script>
</body>
</html>